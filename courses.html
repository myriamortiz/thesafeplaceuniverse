<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ›’ Liste de courses â€“ The Safe Place Universe</title>
  <link rel="stylesheet" href="style.css">
  <script defer src="autoUpdate.js"></script>

  <style>
    .category-title {
      font-size: 20px;
      margin: 20px 0 10px;
      font-weight: 600;
      color: #e590b7;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .shopping-item {
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(255, 255, 255, 0.7);
      border-radius: 15px;
      padding: 10px 15px;
      margin: 8px 0;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    .shopping-item input {
      transform: scale(1.3);
      accent-color: #ffb7d1;
    }
  </style>
</head>

<body>

  <section class="splash">
    <h1>ğŸ›’ Liste de courses</h1>
    <p class="subtitle">GÃ©nÃ©rÃ©e automatiquement pour la semaine âœ¨</p>
  </section>

  <main class="content">
    <div class="card">
      <div id="courses-container">Chargement...</div>
    </div>

    <nav class="menu">
      <a href="alimentation.html">ğŸ± Retour alimentation</a>
    </nav>
  </main>

  <script>
    // ğŸ“ SystÃ¨me de catÃ©gories simples
    const CATEGORIES = {
      "ğŸ¥¬ LÃ©gumes": ["carotte", "courgette", "poivron", "salade", "avocat", "betterave", "aubergine"],
      "ğŸ Fruits": ["pomme", "banane", "framboise", "kiwi", "mangue"],
      "ğŸ— ProtÃ©ines": ["poulet", "saumon", "dinde", "boeuf", "crevette", "oeufs"],
      "ğŸ¥› Laitages chÃ¨vre/brebis": ["brebis", "chÃ¨vre", "yaourt"],
      "ğŸ¥£ Placard": ["riz", "quinoa", "chia", "amandes", "noix", "beurre de cacahuÃ¨te"],
      "ğŸ§‚ Divers": []
    };

    function categorize(item) {
      item = item.toLowerCase();
      for (let cat in CATEGORIES) {
        if (CATEGORIES[cat].some(word => item.includes(word))) {
          return cat;
        }
      }
      return "ğŸ§‚ Divers";
    }

    fetch("data/courses.json?cache=" + Date.now())
      .then(r => r.json())
      .then(data => {
        const container = document.getElementById("courses-container");
        container.innerHTML = "";

        // Regroupe par catÃ©gories
        const grouped = {};
        data.forEach(item => {
          const cat = categorize(item);
          if (!grouped[cat]) grouped[cat] = [];
          grouped[cat].push(item);
        });

        // Affichage joli
        for (let category in grouped) {
          container.innerHTML += `<h3 class="category-title">${category}</h3>`;

          grouped[category].forEach(item => {
            container.innerHTML += `
              <div class="shopping-item">
                <input type="checkbox" id="${item}">
                <label for="${item}">${item}</label>
              </div>
            `;
          });
        }
      })
      .catch(() => {
        document.getElementById("courses-container").innerHTML =
          "<p>Impossible de charger la liste ğŸŒ§</p>";
      });
  </script>

</body>
</html>
