<script>
  fetch("/thesafeplaceuniverse/data/courses.json?cache=" + Date.now())
    .then(r => r.json())
    .then(courses => {
      const container = document.getElementById("courses-container");
      container.innerHTML = "<h2>ğŸ›’ Liste de courses</h2>";

      const listWrapper = document.createElement("div");
      listWrapper.className = "card";

      const ul = document.createElement("ul");
      ul.className = "checklist";

      courses.forEach(item => {
        const li = document.createElement("li");

        const id = "chk-" + item.toLowerCase().replace(/\s+/g, "-");

        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = id;

        if (localStorage.getItem(id) === "true") {
          checkbox.checked = true;
        }

        checkbox.addEventListener("change", () => {
          localStorage.setItem(id, checkbox.checked);
        });

        const label = document.createElement("label");
        label.setAttribute("for", id);
        label.textContent = " " + item;

        li.appendChild(checkbox);
        li.appendChild(label);
        ul.appendChild(li);
      });

      listWrapper.appendChild(ul);
      container.appendChild(listWrapper);
    })
    .catch(() => {
      document.getElementById("courses-container").innerHTML =
        "<p>Impossible de charger la liste de courses ğŸŒ§ï¸</p>";
    });
</script>
