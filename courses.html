<script>
  function getCategory(item) {
    item = item.toLowerCase().trim();

    // Fruits
    if (["pomme","banane","framboise","kiwi","raisin","mandarine","mangue","baies"].some(w => item.includes(w)))
      return "üçé Fruits";

    // L√©gumes
    if (["carotte","courgette","poivron","betterave","salade","avocat","aubergine","√©pinard","haricot"].some(w => item.includes(w)))
      return "ü•¨ L√©gumes";

    // Prot√©ines
    if (["poulet","saumon","crevette","boeuf","dinde","≈ìuf","oeuf","yaourt","tofu"].some(w => item.includes(w)))
      return "üçó Prot√©ines";

    // Laitages ok
    if (["ch√®vre","brebis","fromage"].some(w => item.includes(w)))
      return "ü•õ Laitages ch√®vre/brebis";

    // Placard
    if (["riz","quinoa","chia","amandes","noix","beurre","pain","huile","vinaigre"].some(w => item.includes(w)))
      return "ü•£ Placard";

    return "üßÇ Divers";
  }

  fetch("data/courses.json?cache=" + Date.now())
    .then(r => r.json())
    .then(list => {
      const container = document.getElementById("courses-container");
      container.innerHTML = "";

      const grouped = {};

      list.forEach(item => {
        const cat = getCategory(item);
        if (!grouped[cat]) grouped[cat] = [];
        grouped[cat].push(item);
      });

      for (const cat in grouped) {
        container.innerHTML += `<div class="category">${cat}</div>`;
        grouped[cat].forEach(item => {
          container.innerHTML += `
            <div class="item">
              <input type="checkbox" id="${item}">
              <label for="${item}">${item}</label>
            </div>
          `;
        });
      }
    })
    .catch(() => {
      document.getElementById("courses-container").innerHTML =
        "‚ùå Impossible de charger la liste.";
    });
</script>

